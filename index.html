<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feelin' Baggy â€¢ Retro Booth</title>
    <style>
        :root {
            --neon-pink: #ff00ff;
            --neon-blue: #00f3ff;
            --retro-yellow: #fff300;
            --baggy-teal: #2c5d63;
            --cream: #fefaf0;
        }

        body, html {
            margin: 0; padding: 0;
            height: 100%; width: 100%;
            font-family: 'Helvetica Neue', sans-serif;
            overflow: hidden;
            background-color: #1a1a1a;
            /* 80s Memphis Pattern Background */
            background-image: 
                radial-gradient(var(--neon-pink) 2px, transparent 2px),
                linear-gradient(45deg, transparent 48%, var(--neon-blue) 50%, transparent 52%);
            background-size: 40px 40px, 100px 100px;
        }

        .screen { display: none; flex-direction: column; align-items: center; width: 100%; height: 100%; position: absolute; justify-content: center; }
        .active { display: flex; animation: slideUp 0.6s cubic-bezier(0.2, 0.8, 0.2, 1); }

        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* --- EXTERIOR --- */
        #screen-exterior {
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://www.transparenttextures.com/patterns/cubes.png');
            background-color: var(--baggy-teal);
        }

        .hero-title {
            font-size: clamp(3rem, 10vw, 6rem);
            font-weight: 900;
            color: var(--retro-yellow);
            text-shadow: 4px 4px 0px var(--neon-pink), 8px 8px 0px var(--neon-blue);
            text-transform: uppercase;
            letter-spacing: -2px;
            margin-bottom: 20px;
            text-align: center;
        }

        /* --- INTERIOR --- */
        #screen-interior {
            background: #222;
            border: 15px solid #333; /* Booth Walls */
            box-shadow: inset 0 0 100px #000;
        }

        .camera-ring {
            position: relative;
            padding: 10px;
            border-radius: 20px;
            background: linear-gradient(var(--neon-blue), var(--neon-pink));
            box-shadow: 0 0 50px rgba(0, 243, 255, 0.3);
        }

        video {
            width: 480px;
            height: 360px;
            background: #000;
            border-radius: 10px;
            transform: scaleX(-1);
            display: block;
        }

        /* Scanline Overlay */
        .scanlines {
            position: absolute; top:0; left:0; width:100%; height:100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), 
                        linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
            background-size: 100% 3px, 3px 100%;
            pointer-events: none;
        }

        /* --- THE STRIP --- */
        .strip-drop {
            background: var(--cream);
            padding: 15px;
            width: 220px;
            position: relative;
            box-shadow: 0 30px 60px rgba(0,0,0,0.8);
            animation: fallIn 1.4s ease-out;
            border-bottom: 4px dashed #ccc;
        }

        @keyframes fallIn { from { transform: translateY(-120%); } to { transform: translateY(0); } }

        .photo-slot {
            width: 100%;
            height: 150px;
            background: #eee;
            margin-bottom: 12px;
            overflow: hidden;
            border: 1px solid #ddd;
        }

        .photo-slot img { 
            width: 100%; height: 100%; object-fit: cover; 
            filter: contrast(1.1) brightness(1.05) saturate(1.2);
        }

        /* SMALL LOGO OVERLAY */
        .watermark-logo {
            position: absolute;
            top: 48%; /* Positioned between 2nd and 3rd pic */
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px; /* 50% Smaller than before */
            z-index: 5;
            filter: drop-shadow(0 2px 5px rgba(0,0,0,0.2));
            pointer-events: none;
        }

        /* --- BUTTONS --- */
        .btn-retro {
            background: var(--retro-yellow);
            color: #000;
            border: 4px solid #000;
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: 900;
            text-transform: uppercase;
            cursor: pointer;
            box-shadow: 6px 6px 0px #000;
            transition: 0.1s;
        }

        .btn-retro:hover { transform: translate(-2px, -2px); box-shadow: 8px 8px 0px #000; }
        .btn-retro:active { transform: translate(4px, 4px); box-shadow: 0px 0px 0px #000; }

        .grain-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://www.transparenttextures.com/patterns/stardust.png');
            opacity: 0.15; pointer-events: none; z-index: 100;
        }
    </style>
</head>
<body>

    <div class="grain-overlay"></div>

    <div id="screen-exterior" class="screen active">
        <div class="hero-title">Feelin'<br>Baggy</div>
        <button class="btn-retro" onclick="startBooth()">Enter the Booth</button>
    </div>

    <div id="screen-interior" class="screen">
        <div class="camera-ring">
            <video id="video" autoplay playsinline></video>
            <div class="scanlines"></div>
        </div>
        <div style="margin: 20px; font-weight: bold; color: var(--neon-blue); text-shadow: 2px 2px #000;">
            CAPTURING: <span id="counter">0</span>/4
        </div>
        <button id="snap-btn" class="btn-retro" onclick="snap()">SNAP!</button>
        <button id="print-btn" class="btn-retro" style="display:none; background: var(--neon-pink); color: white;" onclick="renderResults()">PRINT STRIP</button>
    </div>

    <div id="screen-results" class="screen">
        <div class="strip-drop" id="final-strip">
            <div class="photo-slot" id="s1"></div>
            <div class="photo-slot" id="s2"></div>
            <img src="Artboard 1@3x.png" class="watermark-logo" alt="Logo">
            <div class="photo-slot" id="s3"></div>
            <div class="photo-slot" id="s4"></div>
        </div>
        <div style="margin-top: 30px; display: flex; gap: 15px;">
            <button class="btn-retro" style="background: var(--neon-blue);" onclick="downloadStrip()">SAVE PNG</button>
            <button class="btn-retro" style="background: #eee;" onclick="location.reload()">AGAIN?</button>
        </div>
    </div>

    <canvas id="hidden-canvas" width="600" height="450" style="display:none;"></canvas>

    <script>
        let photos = [];
        const video = document.getElementById('video');

        function startBooth() {
            document.getElementById('screen-exterior').classList.remove('active');
            document.getElementById('screen-interior').classList.add('active');
            navigator.mediaDevices.getUserMedia({ video: true }).then(s => video.srcObject = s);
        }

        function snap() {
            if (photos.length >= 4) return;
            const canvas = document.getElementById('hidden-canvas');
            const ctx = canvas.getContext('2d');
            ctx.translate(canvas.width, 0);
            ctx.scale(-1, 1);
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
            ctx.setTransform(1, 0, 0, 1, 0, 0);

            const data = canvas.toDataURL('image/png');
            photos.push(data);
            
            document.getElementById('s' + photos.length).innerHTML = `<img src="${data}">`;
            document.getElementById('counter').innerText = photos.length;

            if (photos.length === 4) {
                document.getElementById('snap-btn').style.display = 'none';
                document.getElementById('print-btn').style.display = 'block';
            }
        }

        function renderResults() {
            document.getElementById('screen-interior').classList.remove('active');
            document.getElementById('screen-results').classList.add('active');
        }

        async function downloadStrip() {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 440;
            canvas.height = 1200;

            ctx.fillStyle = "#fefaf0"; // Cream background
            ctx.fillRect(0,0,440,1200);

            for(let i=0; i<4; i++) {
                const img = new Image();
                img.src = photos[i];
                await img.decode();
                ctx.drawImage(img, 20, 20 + (i * 290), 400, 280);
            }

            // Draw Logo 50% smaller
            const logo = new Image();
            logo.src = 'Artboard 1@3x.png';
            try {
                await logo.decode();
                ctx.drawImage(logo, 145, 530, 150, 80); // Scaled down
            } catch(e){}

            const link = document.createElement('a');
            link.download = 'feelin-baggy-strip.png';
            link.href = canvas.toDataURL();
            link.click();
        }
    </script>
</body>
</html>
